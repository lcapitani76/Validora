<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Validora • NFT File Certification 1.2 (BSC Testnet)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.11.1/dist/ethers.umd.min.js"></script>
  <style>
    :root{--bg:#0b1120;--card:#111827;--muted:#94a3b8;--accent:#22d3ee;--ok:#22c55e;--warn:#f59e0b;--err:#ef4444}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:linear-gradient(180deg,#0b1120,#0f172a);color:#e2e8f0}
    .wrap{max-width:1080px;margin:24px auto;padding:16px}
    h1{font-size:28px;margin:0 0 12px 0}
    .card{background:var(--card);border:1px solid #1f2937;border-radius:16px;padding:18px;box-shadow:0 6px 24px rgba(0,0,0,.25)}
    .footer-log{margin-top:16px}
    .log{font-family:ui-monospace, Menlo, Consolas, "Courier New", monospace;height:220px;overflow:auto;background:#0a0f1e;border-radius:12px;border:1px solid #1f2a3a;padding:12px}

    /* My Certifications */
    .certs{margin-top:18px}
    .cert-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:14px}
    .nft{background:#0a0f1e;border:1px solid #1f2937;border-radius:14px;padding:10px;display:flex;flex-direction:column;gap:8px;overflow:hidden}
    .nft img{width:100%;height:88px;object-fit:contain;background:#000;border-radius:8px}
    .nft .title{font-size:13px}
    .nft .meta{font-size:12px;color:var(--muted);word-break:break-word}
    .nft .head{display:flex;align-items:center;justify-content:space-between;gap:8px}
    .iconbtn{background:transparent;border:1px solid #2a3648;border-radius:8px;padding:6px;line-height:1;cursor:pointer}
    .iconbtn:hover{border-color:#3b4b62}
    .iconbtn svg{width:16px;height:16px;display:block;fill:#93c5fd}
    .truncate{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .nft .title{font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .nft .meta{font-size:11px;color:var(--muted);line-height:1.4;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .nft .links{font-size:12px;margin-top:4px;display:flex;gap:8px}
    .icon-eye{cursor:pointer;color:#93c5fd}
    .icon-eye:hover{text-decoration:underline}
    [data-tooltip]{position:relative;cursor:pointer}
    [data-tooltip]:hover::after{
      content:attr(data-tooltip);
      position:absolute;bottom:125%;left:50%;transform:translateX(-50%);
      background:#111827;color:#e2e8f0;padding:4px 8px;border-radius:6px;font-size:11px;white-space:nowrap;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card certs">
      <h2 style="margin:0" data-i18n="myCerts">My Certifications</h2>
      <div class="muted" data-i18n="myCertsHint">NFTs minted by your connected wallet on this contract.</div>
      <div class="hr"></div>
      <div id="certList" class="cert-grid"></div>
      <div id="emptyState" class="muted" style="display:none;margin-top:8px" data-i18n="noCerts">No certifications found for this wallet.</div>
    </div>
    <div class="footer-log">
      <label data-i18n="log">Log</label>
      <div id="log" class="log"></div>
    </div>
  </div>

<script>
const $ = (id) => document.getElementById(id);

function renderCerts(items){
  const list = $('certList'); const empty = $('emptyState');
  list.innerHTML = '';
  if(!items || items.length === 0){ empty.style.display='block'; return; }
  empty.style.display='none';
  const L = I18N[document.documentElement.lang];
  for(const it of items){
    const tokenUrl = `${EXPLORER}/token/${CONTRACT_ADDR}?a=${it.id}`;
    const card = document.createElement('div'); card.className = 'nft';
    const img = document.createElement('img'); img.alt = 'nft'; img.src = it.image || identiconSVG('0x'+Number(it.id).toString(16).padStart(64,'0'), 140);

    const head = document.createElement('div'); head.className='head';
    const title = document.createElement('div'); title.className='title truncate'; title.innerHTML = `<b>${it.meta?.name || ('Token #' + it.id)}</b>`;
    const eye = document.createElement('button'); eye.className='iconbtn'; eye.title = L.viewOnBsc; eye.innerHTML = `
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 5c-4.5 0-8.4 2.7-10 7 1.6 4.3 5.5 7 10 7s8.4-2.7 10-7c-1.6-4.3-5.5-7-10-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10zm0-2.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/></svg>`;
    eye.addEventListener('click', ()=> window.open(tokenUrl,'_blank'));
    head.appendChild(title); head.appendChild(eye);

    const meta = document.createElement('div'); meta.className='meta';
    const attrs = it.meta?.attributes || [];
    const hashAttr = attrs.find(a=> (a.trait_type||'').toLowerCase().includes('hash'));
    const sizeAttr = attrs.find(a=> (a.trait_type||'').toLowerCase().includes('file size'));
    const hashShort = hashAttr ? String(hashAttr.value).slice(0,6) + '…' + String(hashAttr.value).slice(-4) : null;
    const idShort = '#' + (String(it.id).length>8 ? (String(it.id).slice(0,4)+'…'+String(it.id).slice(-3)) : String(it.id));
    const lines = [];
    lines.push(`ID: ${idShort}`);
    if(hashShort) lines.push(`Hash: ${hashShort}`);
    if(sizeAttr) lines.push(`Size: ${sizeAttr.value}`);
    meta.innerHTML = lines.join('<br/>');

    card.appendChild(img); card.appendChild(head); card.appendChild(meta);
    list.appendChild(card);
  }
}
</script>
</body>
</html>
